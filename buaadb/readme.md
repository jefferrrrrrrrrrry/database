# 数据库课程设计报告

## 1. 系统设计

### 1.1 基本信息

#### 1.1.1 需求分析

* 该学校有多名管理员，描述管理员的信息有：管理员编号、管理员姓名。
* 该学校有多个学院，描述学院的信息有：学院编号、学院名。
* 每个学院有多名教师，描述教师的信息有：教师编号、教师名、教师性别、教师职称。每名教师只能属于一个学院，一个学院可以有多名教师。
* 每个学院有多个班级，描述班级的信息有：班级编号。每个班级只属于一个学院。
* 每个班级有多名学生，每个学生只能属于一个班级。描述学生的信息有：学生编号、学生姓名、学生年龄、学生性别。
* 一个学院可以有多门课程，每门课可以在多个学院开课。描述课程的信息有：课程编号、课程名、开课所在位置、课程类型、课程学分。
* 一名学生可以选择多门课程，一门课程可以被多名学生学。一个学生选定的每一门课程都有一个成绩。

#### 1.1.2 数据流图

#### 1.1.3 数据元素表

|      数据名      |   数据类型   |      含义      |
| :--------------: | :----------: | :------------: |
|       scno       |     int      |  唯一学院编号  |
|      scname      | varchar(20)  |     学院名     |
|       clno       | varchar(20)  |  唯一班级编号  |
|       mno        | varchar (20) | 唯一管理员编号 |
|      mname       | varchar (20) |   管理员姓名   |
|    mpassword     | varchar (20) |   管理员密码   |
|       tno        | varchar (20) |  唯一教师编号  |
|      tname       | varchar (20) |    教师姓名    |
|       tsex       | varchar (1)  |    教师性别    |
|      ttitle      | varchar (20) |    教师职称    |
|    tpassword     | varchar (20) |    教师密码    |
|       sno        | varchar (20) |  唯一学生编号  |
|      sname       | varchar (20) |    学生姓名    |
|       sage       |     int      |    学生年龄    |
|       ssex       | varchar (1)  |    学生性别    |
|      sgrade      |     int      |    学生成绩    |
|     scredit      |     int      |    学生学分    |
|    spassword     | varchar (20) |    学生密码    |
|       cno        | varchar (20) |  唯一课程编号  |
|      cname       | varchar (20) |     课程名     |
|       cpos       | varchar (20) |  开课所在位置  |
|      ctype       | varchar (20) |    课程类型    |
|     ccredit      |     int      |    课程学分    |
|    ccapicity     |     int      |    课程容量    |
|     cremain      |     int      |  课程剩余名额  |
|     cstatus      |     int      |  课程审批状态  |
|   sys_username   | varchar (20) |   唯一用户名   |
| sys_userpassword | varchar (20) |    用户密码    |
|    permission    |     int      |    用户权限    |

### 1.2 E-R图

本系统中包括 6 个实体：学院、班级、用户、管理员、教师、学生、课程。根据数据库的基本信息和功能，6 个实体所对应的 ER 属性图如下：

## 2. 系统实现

### 2.1 实现工具及框架

* 前端：
    + 工具：HTML, CSS, JavaScript
    + 框架：vue
* 后端 ：
    + 工具：Java, MySQL
    + 框架：SpringBoot, Mybatis

### 2.2 功能结构图

### 2.3 表的创建

1. 学院 ( school )

   | 字段名 |   数据类型   |   说明   | 备注 |
      | :----: | :----------: | :------: | :--: |
   |  scno  |     int      | 学院编号 | 主键 |
   | scname | varchar (20) |  学院名  |  ——  |

2. 班级 ( class )

   | 字段名 | 数据类型 |       说明       | 备注 |
      | :----: | :------: | :--------------: | :--: |
   |  clno  |   int    |     班级编号     | 主键 |
   |  scno  |   int    | 班级所在学院编号 | 外键 |

3. 管理员 ( manager )

   |  字段名   |   数据类型   |    说明    | 备注 |
      | :-------: | :----------: | :--------: | :--: |
   |    mno    | varchar (20) | 管理员编号 | 主键 |
   |   mname   | varchar (20) | 管理员姓名 |  ——  |
   | mpassword | varchar (20) | 管理员密码 |  ——  |

4. 教师 ( teacher )

   |  字段名   |   数据类型   |       说明       | 备注 |
      | :-------: | :----------: | :--------------: | :--: |
   |    tno    | varchar (20) |     教师编号     | 主键 |
   |   tname   | varchar (20) |     教师姓名     |  ——  |
   |   tsex    | varchar (1)  |     教师性别     |  ——  |
   |  ttitle   | varchar (20) |     教师职称     |  ——  |
   | tpassword | varchar (20) |     教师密码     |  ——  |
   |   scno    |     int      | 教师所在学院编号 | 外键 |

5. 学生

   |  字段名   |   数据类型   |       说明       | 备注 |
      | :-------: | :----------: | :--------------: | :--: |
   |    sno    | varchar (20) |     学生编号     | 主键 |
   |   sname   | varchar (20) |     学生姓名     |  ——  |
   |   sage    |     int      |     学生年龄     |  ——  |
   |   ssex    | varchar (1)  |     学生性别     |  ——  |
   |  sgrade   |     int      |     学生成绩     |  ——  |
   |  scredit  |     int      |     学生学分     |  ——  |
   | spassword | varchar (20) |     学生密码     |  ——  |
   |   clno    |     int      | 学生所在班级编号 | 外键 |

6. 课程

   |  字段名   |   数据类型   |     说明     | 备注 |
      | :-------: | :----------: | :----------: | :--: |
   |    cno    | varchar (20) |   课程编号   | 主键 |
   |   cname   | varchar (20) |    课程名    |  ——  |
   |   cpos    | varchar (20) | 开课所在位置 |  ——  |
   |   ctype   | varchar (20) |   课程类型   |  ——  |
   |    tno    | varchar (20) | 授课教师编号 | 外键 |
   |  ccredit  |     int      |   课程学分   |  ——  |
   | ccapicity |     int      |   课程容量   |  ——  |
   |  cremain  |     int      | 课程剩余名额 |  ——  |
   |  cstatus  |     int      | 课程审批状态 |  ——  |

7. 用户 ( sys_user )

   |      字段名      |   数据类型   |   说明   | 备注 |
      | :--------------: | :----------: | :------: | :--: |
   |   sys_username   | varchar (20) |  用户名  | 主键 |
   | sys_userpassword | varchar (20) | 用户密码 |  ——  |
   |    permission    |     int      | 用户权限 |  ——  |

## 2.4 安全性设计及不同用户的权限

### 2.4.1 安全性设计

* 所有用户必须使用自己的用户名和密码登录该系统才能使用
* 不同种类的用户在登录之后会进入不同的界面，拥有不同的权限
* 只有管理员才享有增加课程等最高权力

### 2.4.2 不同用户的权限

1. 管理员

    * 增加、更新和删除管理员
    * 更新学院
    * 查询、增加、更新和删除班级
    * 查询、增加、更新和删除教师
    * 查询、增加、更新和删除学生
    * 查询、更新所有课程
    * 审批教师提交的增加课程的申请
    * 修改自己的密码
    * 修改其他用户的密码

2. 教师

    * 向管理员提交增加课程的申请

    + 查询自己已经通过审批和正在审批的课程
    + 登记学生的课程成绩
    + 修改自己的密码

3. 学生

    * 查询所有课程
    * 查询自己已选课程
    * 选课和退课
    * 查询自己所选课程的成绩

### 2.4 实体的操作、网址和参数

1. 学院 ( /school )

   |   操作   |  网址   |   参数   |
      | :------: | :-----: | :------: |
   | 更新学院 | /update | 学院实体 |

2. 班级 ( /class )

   |     操作     |  网址   |   参数   |
      | :----------: | :-----: | :------: |
   | 查询所有班级 |    /    |    ——    |
   |   增加班级   |  /add   | 班级实体 |
   |   删除班级   | /{clno} | 班级编号 |
   |   更新班级   | /update | 班级实体 |

3. 管理员 ( / manager )

   |    操作    |  网址   |          参数          |
      | :--------: | :-----: | :--------------------: |
   | 查找管理员 |  /find  | 管理员编号，管理员姓名 |
   | 增加管理员 |  /add   |       管理员实体       |
   | 删除管理员 | /{mno}  |       管理员编号       |
   | 更新管理员 | /update |       管理员实体       |

4. 教师 ( /teacher )

   |             操作             |     网址     |                      参数                      |
      | :--------------------------: | :----------: | :--------------------------------------------: |
   |           查找教师           |    /find     |               教师编号，教师姓名               |
   | 查询教师的已经通过审批的课程 | /findApprove | 课程编号，课程名，教师姓名，页面数量，页面大小 |
   |   查询教师的正在审批的课程   |  /findPend   | 课程编号，课程名，教师姓名，页面数量，页面大小 |
   |           增加教师           |     /add     |                    教师实体                    |
   |           删除教师           |    /{tno}    |                    教师编号                    |
   |           更新教师           |   /update    |                    教师实体                    |

5. 学生 ( /student )

   |   操作   |     网址      |                  参数                  |
      | :------: | :-----------: | :------------------------------------: |
   | 查找学生 | /findstudent  | 学生编号，学生姓名，页面数量，页面大小 |
   | 学生选课 | /coursechosen |      课程编号，页面数量，页面大小      |
   | 增加学生 |     /add      |                学生实体                |
   | 删除学生 |    /{sno}     |                学生编号                |
   | 更新学生 |    /update    |                学生实体                |

6. 课程 ( /course )

   |          操作          |      网址      |                           参数                           |
      | :--------------------: | :------------: | :------------------------------------------------------: |
   |      查询所有课程      |       /        |                            ——                            |
   |       查询总课表       |     /find      |      课程编号，课程名，教师姓名，页面数量，页面大小      |
   | 教师查询自己开设的课程 |  /teacherfind  |      课程编号，课程名，教师姓名，页面数量，页面大小      |
   |        学生选课        | /selectCourse  |                         课程编号                         |
   |        学生退课        |   /withdraw    |                         课程编号                         |
   |    教师提交加课申请    |      /add      |                         课程实体                         |
   |   管理员提交加课申请   |  /manageradd   |                         课程实体                         |
   |     管理员同意加课     |    /approve    |                         课程编号                         |
   |     管理员拒绝加课     |  /disapprove   |                         课程编号                         |
   |    学生查询已选课程    | /studentselect | 学生编号，课程编号，课程名，教师姓名，页面数量，页面大小 |
   |        删除课程        |     /{cno}     |                         课程编号                         |
   |      登记学生成绩      |  /recordgrade  |                         Sel 对象                         |
   |        更新课程        |    /update     |                         课程实体                         |
   |   计算课程的平均分数   |    /average    |                         课程编号                         |

7. 用户 ( /user )

   |         操作         |        网址         |        参数        |
      | :------------------: | :-----------------: | :----------------: |
   |       用户登录       |       /login        |      登录信息      |
   |  用户修改自己的密码  |   /changepassword   |        密码        |
   | 管理员修改用户的密码 | /changeuserpassword |      用户对象      |
   |     查询所有用户     |        /user        | 页面大小，页面数量 |

8. Sel对象 ( /sel )

   |     操作      |   网址    |           参数           |
      | :-----------: | :-------: | :----------------------: |
   | 增加 Sel 对象 |   /add    |         Sel 对象         |
   | 删除 Sel 对象 |   /del    |         Sel 对象         |
   | 登记学生成绩  | /setScore | 课程编号，学生编号，成绩 |
   | 学生查询成绩  | /getScore |    课程编号，学生编号    |

9. 目录( /menu )

   |     操作     | 网址 | 参数 |
      | :----------: | :--: | :--: |
   | 查找所有目录 |  /   |  ——  |

10. 消息 ( /message )

    |   操作   | 网址  |       参数       |
        | :------: | :---: | :--------------: |
    | 发送消息 | /send | 接收者，消息内容 |


### 2.9 收获与体会

​		在设计和实现选课系统的过程中，我们小组深入地理解了数据库在系统中的核心作用。数据库不仅存储了所有的课程信息和用户信息，而且通过合理的表关系设计，确保了数据的一致性和完整性。这次设计实践让我们更加明白，一个高效、稳定的数据库是构建任何复杂系统的基础。
​		首先，我们学到了如何进行需求分析。在设计选课系统数据库之前，我们需要明确系统的功能需求，例如用户管理、课程查询、选课、退课等，并根据需求设计出数据流图和设计元素表；其次，我们深入理解了数据库的 3NF 范式等级。在设计数据库时，我们需要遵循 3NF 原则，避免数据冗余和不一致性。例如，我们通过合理地设计用户表、课程表、选课表等，确保了数据的完整性。同时，通过外键约束、唯一约束等手段，确保了数据的一致性；此外，我们加深了对数据库的创建、修改、删除的方法的理解，通过导入表、删除表和修改表熟悉了表的操作；不仅如此，通过写 Java 程序实现这一个小型应用，让我们对前后端分离的软件工程设计有了初步认识，代码能力得到加强。
​		总的来说，设计选课系统数据库的过程让我们收获颇丰。我们不仅学到了如何进行需求分析、规范化设计等知识，而且也明白了数据库设计的重要性。这次实践让我们更加坚定了从事数据库相关工作的决心，也为我们未来的学习和工作提供了宝贵的经验。